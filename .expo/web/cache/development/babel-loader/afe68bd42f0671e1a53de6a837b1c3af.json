{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\EMBEDED\\\\Final_Project\\\\semicolon_app\\\\screens\\\\story\\\\VideoStory.js\";\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 80;\\n  height: 80;\\n  border-radius: 40px;\\n  border: 10px solid \", \";\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  flex: 1;\\n  justify-content: center;\\n  align-items: center;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { Camera } from \"expo-camera\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport * as Permissions from \"expo-permissions\";\nimport constants from \"../../Constants\";\nimport Loader from \"../../components/Loader\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport styles from \"../../styles\";\nvar View = styled.View(_templateObject());\nvar Icon = styled.View(_templateObject2());\nvar Button = styled.View(_templateObject3(), styles.lightGreyColor);\nexport default (function (_ref) {\n  var navigation = _ref.navigation;\n\n  if (navigation) {\n    var cameraRef = useRef();\n\n    var _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        video = _useState2[0],\n        setVideo = _useState2[1];\n\n    var _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        uri = _useState4[0],\n        setUri = _useState4[1];\n\n    var _useState5 = useState(null),\n        _useState6 = _slicedToArray(_useState5, 2),\n        type = _useState6[0],\n        setType = _useState6[1];\n\n    var _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        recording = _useState8[0],\n        setRecording = _useState8[1];\n\n    var _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        showCamera = _useState10[0],\n        setsShowCamera = _useState10[1];\n\n    var _useState11 = useState(true),\n        _useState12 = _slicedToArray(_useState11, 2),\n        loading = _useState12[0],\n        setLoading = _useState12[1];\n\n    var _saveVideo = function _saveVideo() {\n      var asset;\n      return _regeneratorRuntime.async(function _saveVideo$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(MediaLibrary.createAssetAsync(uri));\n\n            case 2:\n              asset = _context.sent;\n              console.log(asset);\n\n              if (asset) {\n                navigation.navigate(\"StoryUpload\", {\n                  type: type,\n                  story: asset,\n                  uri: uri\n                });\n                setVideo(null);\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    var _StopRecord = function _StopRecord() {\n      return _regeneratorRuntime.async(function _StopRecord$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setRecording(false);\n              cameraRef.current.stopRecording();\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    var _StartRecord = function _StartRecord() {\n      var _await$cameraRef$curr, uri, _await$cameraRef$curr2, codec;\n\n      return _regeneratorRuntime.async(function _StartRecord$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setRecording(true);\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(cameraRef.current.recordAsync());\n\n            case 3:\n              _await$cameraRef$curr = _context3.sent;\n              uri = _await$cameraRef$curr.uri;\n              _await$cameraRef$curr2 = _await$cameraRef$curr.codec;\n              codec = _await$cameraRef$curr2 === void 0 ? \"mp4\" : _await$cameraRef$curr2;\n              console.log(uri);\n              setUri(uri);\n              setType(codec);\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    var pushVideo = function pushVideo() {\n      _StartRecord();\n    };\n\n    var pullVideo = function pullVideo() {\n      _StopRecord();\n    };\n\n    var _showCamera = function _showCamera() {\n      var _await$Permissions$as, status;\n\n      return _regeneratorRuntime.async(function _showCamera$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n            case 3:\n              _await$Permissions$as = _context4.sent;\n              status = _await$Permissions$as.status;\n\n              if (status === \"granted\") {\n                setsShowCamera(true);\n              }\n\n              _context4.next = 12;\n              break;\n\n            case 8:\n              _context4.prev = 8;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.log(_context4.t0);\n              setsShowCamera(false);\n\n            case 12:\n              _context4.prev = 12;\n              setLoading(false);\n              return _context4.finish(12);\n\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, [[0, 8, 12, 15]], Promise);\n    };\n\n    useEffect(function () {\n      _showCamera();\n    }, []);\n    return React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 5\n      }\n    }, loading ? React.createElement(Loader, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }\n    }) : showCamera ? React.createElement(React.Fragment, null, React.createElement(Camera, {\n      ref: cameraRef,\n      style: {\n        justifyContent: \"flex-end\",\n        alignItems: \"center\",\n        flex: 1,\n        width: \"100%\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }\n    }, uri && React.createElement(TouchableOpacity, {\n      onPress: _saveVideo,\n      style: {\n        padding: 20,\n        width: \"100%\",\n        backgroundColor: \"#fff\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    }, React.createElement(Text, {\n      style: {\n        textAlign: \"center\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }, \"save\")), React.createElement(TouchableOpacity, {\n      onLongPress: pushVideo,\n      delayLongPress: 200,\n      onPressOut: pullVideo,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }\n    }, React.createElement(Button, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }\n    })))) : null);\n  } else {\n    return null;\n  }\n});","map":{"version":3,"sources":["D:/EMBEDED/Final_Project/semicolon_app/screens/story/VideoStory.js"],"names":["React","useState","useEffect","useRef","styled","Camera","MediaLibrary","Ionicons","Permissions","constants","Loader","styles","View","Icon","Button","lightGreyColor","navigation","cameraRef","video","setVideo","uri","setUri","type","setType","recording","setRecording","showCamera","setsShowCamera","loading","setLoading","_saveVideo","createAssetAsync","asset","console","log","navigate","story","_StopRecord","current","stopRecording","_StartRecord","recordAsync","codec","pushVideo","pullVideo","_showCamera","askAsync","CAMERA","status","justifyContent","alignItems","flex","width","padding","backgroundColor","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Camera } from \"expo-camera\";\r\nimport * as MediaLibrary from \"expo-media-library\";\r\nimport { Ionicons } from \"@expo/vector-icons\";\r\nimport * as Permissions from \"expo-permissions\";\r\nimport constants from \"../../Constants\";\r\nimport Loader from \"../../components/Loader\";\r\nimport { TouchableOpacity, Platform, Text } from \"react-native\";\r\nimport styles from \"../../styles\";\r\n\r\nconst View = styled.View`\r\n  flex: 1;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nconst Icon = styled.View``;\r\n\r\nconst Button = styled.View`\r\n  width: 80;\r\n  height: 80;\r\n  border-radius: 40px;\r\n  border: 10px solid ${styles.lightGreyColor};\r\n`;\r\n\r\nexport default ({ navigation }) => {\r\n  \r\n  if (navigation) {\r\n    const cameraRef = useRef();\r\n \r\n  const [video, setVideo] = useState(null);\r\n  const [uri, setUri] = useState(null);\r\n  const [type, setType] = useState(null);\r\n  const [recording, setRecording] = useState(false);\r\n  const [showCamera, setsShowCamera] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const _saveVideo = async () => {\r\n    const asset = await MediaLibrary.createAssetAsync(uri);\r\n    console.log(asset)\r\n    if (asset) {\r\n      navigation.navigate(\"StoryUpload\", { type: type, story: asset, uri });\r\n      setVideo(null)\r\n    }\r\n  };\r\n\r\n  const _StopRecord = async () => {\r\n    setRecording(false)\r\n    cameraRef.current.stopRecording();\r\n  }\r\n  const _StartRecord = async () => {\r\n    // if (cameraRef) {\r\n    setRecording(true)\r\n    const { uri, codec = \"mp4\" } = await cameraRef.current.recordAsync();\r\n    console.log(uri)\r\n    setUri(uri)\r\n    setType(codec)\r\n    // setVideo(svideo)\r\n    // }\r\n  }\r\n  const pushVideo = () => {\r\n     \r\n      _StartRecord();\r\n    \r\n  };\r\n\r\n    const pullVideo = () => {\r\n    \r\n      _StopRecord();\r\n    \r\n  };\r\n\r\n  const _showCamera = async () => {\r\n    try {\r\n      const { status } = await Permissions.askAsync(Permissions.CAMERA);\r\n\r\n      if (status === \"granted\") {\r\n        setsShowCamera(true);\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n      setsShowCamera(false);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n    };\r\n    \r\n\r\n\r\n  useEffect(() => {\r\n    _showCamera();\r\n  }, []);\r\n\r\n  return (\r\n    <View>\r\n      {loading ? (\r\n        <Loader />\r\n      ) : showCamera ? (\r\n        <>\r\n          <Camera\r\n            ref={cameraRef}\r\n            style={{\r\n              justifyContent: \"flex-end\",\r\n              alignItems: \"center\",\r\n              flex: 1,\r\n              width: \"100%\"\r\n            }}\r\n          >\r\n            {uri && (\r\n              <TouchableOpacity\r\n                onPress={_saveVideo}\r\n                style={{\r\n                  padding: 20,\r\n                  width: \"100%\",\r\n                  backgroundColor: \"#fff\"\r\n                }}\r\n              >\r\n                <Text style={{ textAlign: \"center\" }}>save</Text>\r\n              </TouchableOpacity>\r\n            )}\r\n              <TouchableOpacity\r\n                onLongPress={pushVideo} delayLongPress={200}\r\n                onPressOut={pullVideo}\r\n              //onPress={toogleRecord}\r\n              // style={{\r\n              //   padding: 20,\r\n              //   width: \"100%\",\r\n              //   backgroundColor: recording ? \"#ef4f84\" : \"#4fef97\"\r\n              // }}\r\n            >\r\n              {/* <Text style={{ textAlign: \"center\" }}>\r\n                {recording ? \"Stop\" : \"Record\"}\r\n              </Text> */}\r\n                <Button />\r\n            </TouchableOpacity>\r\n          </Camera>\r\n          {/* <View>\r\n            <TouchableOpacity onPress={takePhoto} disabled={!canTakePhoto}>\r\n              <Button />\r\n            </TouchableOpacity>\r\n          </View> */}\r\n           \r\n          </>\r\n          \r\n          \r\n      ) : null}\r\n    </View>\r\n  )\r\n  }\r\n  else {\r\n    return null;\r\n  }\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}
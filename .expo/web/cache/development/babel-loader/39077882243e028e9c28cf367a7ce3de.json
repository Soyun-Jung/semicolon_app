{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\EMBEDED\\\\Final_Project\\\\semicolon_app\\\\screens\\\\story\\\\MakeStory.js\";\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 60;\\n  height: 60;\\n  border-radius: 30px;\\n  background : \", \";\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 80;\\n  height: 80;\\n  border-radius: 40px;\\n  border: 10px solid \", \";\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  border: 1.5px solid black;\\n  flex : 1;\\n  justify-content: center;\\n  align-items: center;\\n  height : 100%;\\n\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  flex: 1;\\n  justify-content: center;\\n  align-items: center;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { Camera } from \"expo-camera\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport * as Permissions from \"expo-permissions\";\nimport constants from \"../../Constants\";\nimport Loader from \"../../components/Loader\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport styles from \"../../styles\";\nvar View = styled.View(_templateObject());\nvar Bottom = styled.TouchableOpacity(_templateObject2());\nvar Icon = styled.View(_templateObject3());\nvar Button = styled.View(_templateObject4(), styles.lightGreyColor);\nvar VideoButton = styled.View(_templateObject5(), styles.lightGreyColor);\nexport default (function (_ref) {\n  var navigation = _ref.navigation;\n  var cameraRef = useRef();\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      picture = _useState2[0],\n      setPicture = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      uri = _useState4[0],\n      setUri = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      type = _useState6[0],\n      setType = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      recording = _useState8[0],\n      setRecording = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      showCamera = _useState10[0],\n      setsShowCamera = _useState10[1];\n\n  var _useState11 = useState(true),\n      _useState12 = _slicedToArray(_useState11, 2),\n      loading = _useState12[0],\n      setLoading = _useState12[1];\n\n  var _useState13 = useState(Camera.Constants.Type.back),\n      _useState14 = _slicedToArray(_useState13, 2),\n      cameraType = _useState14[0],\n      setCameraType = _useState14[1];\n\n  var _useState15 = useState(true),\n      _useState16 = _slicedToArray(_useState15, 2),\n      canTakePhoto = _useState16[0],\n      setCanTakePhoto = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      hasPermission = _useState18[0],\n      setHasPermission = _useState18[1];\n\n  var takePhoto = function takePhoto() {\n    var _await$cameraRef$curr, _uri, asset;\n\n    return _regeneratorRuntime.async(function takePhoto$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (canTakePhoto) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            _context.prev = 2;\n            setCanTakePhoto(false);\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(cameraRef.current.takePictureAsync({\n              quality: 1\n            }));\n\n          case 6:\n            _await$cameraRef$curr = _context.sent;\n            _uri = _await$cameraRef$curr.uri;\n            _context.next = 10;\n            return _regeneratorRuntime.awrap(MediaLibrary.createAssetAsync(_uri));\n\n          case 10:\n            asset = _context.sent;\n            setCanTakePhoto(true);\n            navigation.navigate(\"StoryUpload\", {\n              photo: asset\n            });\n            _context.next = 19;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](2);\n            console.log(_context.t0);\n            setCanTakePhoto(true);\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[2, 15]], Promise);\n  };\n\n  var askPermission = function askPermission() {\n    var _await$Permissions$as, status;\n\n    return _regeneratorRuntime.async(function askPermission$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n          case 3:\n            _await$Permissions$as = _context2.sent;\n            status = _await$Permissions$as.status;\n\n            if (status === \"granted\") {\n              setHasPermission(true);\n            }\n\n            _context2.next = 12;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n            setHasPermission(false);\n\n          case 12:\n            _context2.prev = 12;\n            setLoading(false);\n            return _context2.finish(12);\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 8, 12, 15]], Promise);\n  };\n\n  var toggleType = function toggleType() {\n    if (cameraType === Camera.Constants.Type.front) {\n      setCameraType(Camera.Constants.Type.back);\n    } else {\n      setCameraType(Camera.Constants.Type.front);\n    }\n  };\n\n  useEffect(function () {\n    askPermission();\n  }, []);\n\n  var _saveVideo = function _saveVideo() {\n    var asset;\n    return _regeneratorRuntime.async(function _saveVideo$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(MediaLibrary.createAssetAsync(uri));\n\n          case 2:\n            asset = _context3.sent;\n            console.log(asset);\n\n            if (asset) {\n              navigation.navigate(\"StoryUpload\", {\n                type: type,\n                story: asset,\n                uri: uri\n              });\n              setUri(null);\n            }\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _StopRecord = function _StopRecord() {\n    return _regeneratorRuntime.async(function _StopRecord$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            cameraRef.current.stopRecording();\n\n            _saveVideo();\n\n            setRecording(false);\n\n          case 3:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _StartRecord = function _StartRecord() {\n    var _await$cameraRef$curr2, uri, _await$cameraRef$curr3, codec;\n\n    return _regeneratorRuntime.async(function _StartRecord$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            setRecording(true);\n            _context5.next = 3;\n            return _regeneratorRuntime.awrap(cameraRef.current.recordAsync());\n\n          case 3:\n            _await$cameraRef$curr2 = _context5.sent;\n            uri = _await$cameraRef$curr2.uri;\n            _await$cameraRef$curr3 = _await$cameraRef$curr2.codec;\n            codec = _await$cameraRef$curr3 === void 0 ? \"mp4\" : _await$cameraRef$curr3;\n            console.log(uri);\n            setUri(uri);\n            setType(codec);\n\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var pushVideo = function pushVideo() {\n    _StartRecord();\n  };\n\n  var pullVideo = function pullVideo() {\n    _StopRecord();\n  };\n\n  var _showCamera = function _showCamera() {\n    var _await$Permissions$as2, status;\n\n    return _regeneratorRuntime.async(function _showCamera$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.prev = 0;\n            _context6.next = 3;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n          case 3:\n            _await$Permissions$as2 = _context6.sent;\n            status = _await$Permissions$as2.status;\n\n            if (status === \"granted\") {\n              setsShowCamera(true);\n            }\n\n            _context6.next = 12;\n            break;\n\n          case 8:\n            _context6.prev = 8;\n            _context6.t0 = _context6[\"catch\"](0);\n            console.log(_context6.t0);\n            setsShowCamera(false);\n\n          case 12:\n            _context6.prev = 12;\n            setLoading(false);\n            return _context6.finish(12);\n\n          case 15:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, [[0, 8, 12, 15]], Promise);\n  };\n\n  useEffect(function () {\n    _showCamera();\n  }, []);\n  return React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, loading ? React.createElement(Loader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }) : showCamera ? React.createElement(React.Fragment, null, React.createElement(Camera, {\n    ref: cameraRef,\n    type: cameraType,\n    style: {\n      justifyContent: \"flex-end\",\n      padding: 15,\n      width: constants.width,\n      height: constants.height / 1.22\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  }, picture ? React.createElement(TouchableOpacity, {\n    onPress: takePhoto,\n    disabled: !canTakePhoto,\n    style: {\n      textAlign: \"center\",\n      paddingLeft: constants.width / 2 - 55\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }, React.createElement(Button, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  })) : React.createElement(TouchableOpacity, {\n    onLongPress: pushVideo,\n    onPressOut: pullVideo,\n    style: {\n      textAlign: \"center\",\n      paddingLeft: constants.width / 2 - 45\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }, React.createElement(VideoButton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 21\n    }\n  }))), React.createElement(View, {\n    style: {\n      flexDirection: \"row\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 23\n    }\n  }, React.createElement(React.Fragment, null, React.createElement(Bottom, {\n    onPress: function onPress() {\n      return setPicture(true);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 19\n    }\n  }, \"\\uC0AC\\uC9C4 \\uCD2C\\uC601\")), React.createElement(Bottom, {\n    onPress: function onPress() {\n      return setPicture(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }, \"\\uB3D9\\uC601\\uC0C1 \\uCD2C\\uC601\"))))) : null);\n});","map":{"version":3,"sources":["D:/EMBEDED/Final_Project/semicolon_app/screens/story/MakeStory.js"],"names":["React","useState","useEffect","useRef","styled","Camera","MediaLibrary","Ionicons","Permissions","constants","Loader","styles","View","Bottom","TouchableOpacity","Icon","Button","lightGreyColor","VideoButton","navigation","cameraRef","picture","setPicture","uri","setUri","type","setType","recording","setRecording","showCamera","setsShowCamera","loading","setLoading","Constants","Type","back","cameraType","setCameraType","canTakePhoto","setCanTakePhoto","hasPermission","setHasPermission","takePhoto","current","takePictureAsync","quality","createAssetAsync","asset","navigate","photo","console","log","askPermission","askAsync","CAMERA","status","toggleType","front","_saveVideo","story","_StopRecord","stopRecording","_StartRecord","recordAsync","codec","pushVideo","pullVideo","_showCamera","justifyContent","padding","width","height","textAlign","paddingLeft","flexDirection"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Camera } from \"expo-camera\";\r\nimport * as MediaLibrary from \"expo-media-library\";\r\nimport { Ionicons } from \"@expo/vector-icons\";\r\nimport * as Permissions from \"expo-permissions\";\r\nimport constants from \"../../Constants\";\r\nimport Loader from \"../../components/Loader\";\r\nimport { TouchableOpacity, Platform, Text } from \"react-native\";\r\nimport styles from \"../../styles\";\r\n\r\nconst View = styled.View`\r\n  flex: 1;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nconst Bottom = styled.TouchableOpacity`\r\n  border: 1.5px solid black;\r\n  flex : 1;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height : 100%;\r\n\r\n`;\r\n\r\nconst Icon = styled.View``;\r\n\r\nconst Button = styled.View`\r\n  width: 80;\r\n  height: 80;\r\n  border-radius: 40px;\r\n  border: 10px solid ${styles.lightGreyColor};\r\n`;\r\n\r\nconst VideoButton = styled.View`\r\n  width: 60;\r\n  height: 60;\r\n  border-radius: 30px;\r\n  background : ${styles.lightGreyColor};\r\n`;\r\n\r\nexport default ({ navigation }) => {\r\n  \r\n  const cameraRef = useRef();\r\n  const [picture, setPicture] = useState(true);\r\n  const [uri, setUri] = useState(null);\r\n  const [type, setType] = useState(null);\r\n  const [recording, setRecording] = useState(false);\r\n  const [showCamera, setsShowCamera] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [cameraType, setCameraType] = useState(Camera.Constants.Type.back);\r\n  const [canTakePhoto, setCanTakePhoto] = useState(true);\r\n  const [hasPermission, setHasPermission] = useState(false);\r\n  const takePhoto = async () => {\r\n      if (!canTakePhoto) {\r\n        return;\r\n      }\r\n      try {\r\n        setCanTakePhoto(false);\r\n        const { uri } = await cameraRef.current.takePictureAsync({\r\n          quality: 1\r\n        });\r\n        const asset = await MediaLibrary.createAssetAsync(uri);\r\n        setCanTakePhoto(true);\r\n        navigation.navigate(\"StoryUpload\", { photo: asset });\r\n      } catch (e) {\r\n        console.log(e);\r\n        setCanTakePhoto(true);\r\n      }\r\n    };\r\n    const askPermission = async () => {\r\n      try {\r\n        const { status } = await Permissions.askAsync(Permissions.CAMERA);\r\n\r\n        if (status === \"granted\") {\r\n          setHasPermission(true);\r\n        }\r\n      } catch (e) {\r\n        console.log(e);\r\n        setHasPermission(false);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    const toggleType = () => {\r\n      if (cameraType === Camera.Constants.Type.front) {\r\n        setCameraType(Camera.Constants.Type.back);\r\n      } else {\r\n        setCameraType(Camera.Constants.Type.front);\r\n      }\r\n    };\r\n    useEffect(() => {\r\n      askPermission();\r\n    }, []);\r\n      \r\n  const _saveVideo = async () => {\r\n    const asset = await MediaLibrary.createAssetAsync(uri);\r\n    console.log(asset)\r\n    if (asset) {\r\n      navigation.navigate(\"StoryUpload\", { type: type, story: asset, uri });\r\n      setUri(null)\r\n    }\r\n  };\r\n\r\n  const _StopRecord = async () => {\r\n    \r\n    cameraRef.current.stopRecording();\r\n    _saveVideo();\r\n    setRecording(false)\r\n  }\r\n  const _StartRecord = async () => {\r\n    // if (cameraRef) {\r\n    setRecording(true)\r\n    const { uri, codec = \"mp4\" } = await cameraRef.current.recordAsync();\r\n    console.log(uri)\r\n    setUri(uri)\r\n    setType(codec)\r\n    // setVideo(svideo)\r\n    // }\r\n  }\r\n  const pushVideo = () => {\r\n     \r\n      _StartRecord();\r\n    \r\n  };\r\n\r\n    const pullVideo = () => {\r\n    \r\n      _StopRecord();\r\n      \r\n    \r\n  };\r\n\r\n  const _showCamera = async () => {\r\n    try {\r\n      const { status } = await Permissions.askAsync(Permissions.CAMERA);\r\n\r\n      if (status === \"granted\") {\r\n        setsShowCamera(true);\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n      setsShowCamera(false);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    _showCamera();\r\n  }, []);\r\n\r\n  return (\r\n    <View>\r\n      {loading ? (\r\n        <Loader />\r\n      ) : showCamera ? (\r\n        <>\r\n          <Camera\r\n              ref={cameraRef}\r\n              type={cameraType}\r\n              style={{\r\n                justifyContent: \"flex-end\",\r\n                padding: 15,\r\n                width: constants.width,\r\n                height: constants.height/1.22\r\n              }}\r\n            >\r\n              {picture ? (\r\n              \r\n              <TouchableOpacity\r\n                onPress={takePhoto}\r\n                disabled={!canTakePhoto}\r\n                              style={\r\n                                  {\r\n                                  textAlign: \"center\",\r\n                                  paddingLeft : constants.width/2-55}\r\n                              }\r\n              >\r\n                <Button />\r\n              </TouchableOpacity>\r\n              )\r\n              :\r\n              (\r\n                <TouchableOpacity\r\n                    onLongPress={pushVideo}\r\n                    //delayLongPress={200}\r\n                    onPressOut={pullVideo}\r\n                    style={\r\n                      {\r\n                        textAlign: \"center\",\r\n                        paddingLeft: constants.width / 2 - 45\r\n                      }\r\n                    }\r\n              >\r\n                    <VideoButton />\r\n              </TouchableOpacity>\r\n              )\r\n      }\r\n                 \r\n                            \r\n                      </Camera>\r\n            \r\n                      <View style={{flexDirection: \"row\"}}>\r\n              <>\r\n               \r\n                <Bottom onPress={()=>setPicture(true)}>\r\n                  <Text>사진 촬영</Text>\r\n                  </Bottom>\r\n                  \r\n                <Bottom onPress={()=>setPicture(false)}>\r\n                <Text>동영상 촬영</Text>\r\n                </Bottom>\r\n                </>\r\n          </View>\r\n        </>\r\n                  \r\n      ) : null}\r\n    </View>\r\n  )  \r\n}"]},"metadata":{},"sourceType":"module"}